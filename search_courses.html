<!--A Design by W3layouts
Author: W3layout
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE html>
<html>
<head>
<title>The Learn Center Flat Responsive Education Website Template | About :: w3layouts</title>
<meta name="viewport" content="width=device-width, initial-scale=1">	
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<meta name="keywords" content="Bootstrap Responsive Templates, Iphone Compatible Templates, Smartphone Compatible Templates, Ipad Compatible Templates, Flat Responsive Templates"/>
<link href="css/bootstrap.css" rel='stylesheet' type='text/css' />
<link href="css/style.css" rel='stylesheet' type='text/css' />
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
<script src="js/jquery.min.js"></script>  
<!---- start-smoth-scrolling---->
<script type="text/javascript" src="js/move-top.js"></script>
<script type="text/javascript" src="js/easing.js"></script>
<script type="text/javascript">
			jQuery(document).ready(function($) {
				$(".scroll").click(function(event){		
					event.preventDefault();
					$('html,body').animate({scrollTop:$(this.hash).offset().top},1000);
				});
			});
		</script>

<!---- start-smoth-scrolling---->
<script>
$( document ).ready(function() {
if ( $('[type="date"]').prop('type') != 'date' ) {
    $('[type="date"]').datepicker();
}
});
</script>
<style>
button {
  margin: 0 10px 0 0;
  padding: 15px 45px;
  font-size: 12px;
  line-height: 1.8;
  appearance: none;
  box-shadow: none;
  border-radius: 0;
  float : right;
}

button:focus {
  outline: none
}
section.flat button {
  color: #fff;
  background-color: #6496c8;
  text-shadow: -1px 1px #417cb8;
  border: none;
}

section.flat button:hover,
section.flat button.hover {
  background-color: #346392;
  text-shadow: -1px 1px #27496d;
}

section.flat button:active,
section.flat button.active {
  background-color: #27496d;
  text-shadow: -1px 1px #193047;
}
</style>
<script charset="utf-8" src="js/apiomat.js"></script>
<script charset="utf-8" src="js/jstorage.js"></script>
<script type="text/javascript"src="js/lodash.min.js"></script>
</head>
<body onload="init()">
	<div class="banner1" id="home">
		<div class="container">
			<div class="header">
				<div class="menu">
                                     <a class="toggleMenu" href="#"><img src="images/menu-icon.png" alt="" /> </a>
					<ul class="nav" id="nav">
					<li><a href="dashboard-1.html" class="active">Dashboard</a></li>
					<li class="active"><a href="search_courses.html">Pencarian Kursus</a></li>
					<li><a href="courses-1.html">Kursus Saya</a></li>
					<li><a href="#">Logout</a></li>
					</ul>
                                  <!----start-top-nav-script---->
		                      <script type="text/javascript" src="js/responsive-nav.js"></script>
					<script type="text/javascript">
					jQuery(document).ready(function($) {
						$(".scroll").click(function(event){		
							event.preventDefault();
							$('html,body').animate({scrollTop:$(this.hash).offset().top},1000);
						});
					});
					</script>
		<!----//End-top-nav-script---->
				</div>
				<div class="clearfix"> </div>
			</div>
			<!--/start-text-slider-->
		
	 <!--//text-slider-->
		</div>
	</div>
	<!--start-about-->
	
	<!--end-about-->
	<!--start-vision-->
	<div class="success">
		<div class="container">
			<div class="success-main">
				<div class="col-md-12 success-left">
					<h3>Pencarian Kursus</h3>
					
					
					<div class="success-bottom">
						<div class="success-bottom-left">
							<h6>3</h6>
						</div>
						<div class="success-bottom-right">
							<p>Pengajar.</p>
							<div class="contact-text">
							 <input id="pengajar" type="text"  placeholder="Pengajar" />
							 <p>Nama Kursus</p>
							<input id="nama_kursus" type="text"  placeholder="Nama Kursus" />
					        </div>
							
				           
						</div>
						<div class="clearfix"> </div>
					</div>
					
					<section class="flat">
						<button onclick="searchTask()">Cari</button> 					
					</section><br><br>	
					<br><p id="statusS"></p><br>
				<br>
				<table class="table table-striped table-bordered table-hover" >
                  <thead>
                    <tr>
					  
                      <th>Nama Kursus</th>
					  <th>Pengajar</th>
					  <th>Deskripsi</th>
					  <th>Tanggal</th>
					  <th>Jam</th>
					  <th>Aktivitas</th>
                    </tr>
                  </thead>

                  <tbody id="daftar_kursus">
				 
				  </tbody>
                </table>
				</div>
				
				
				<div class="clearfix"> </div>
			</div>
		</div>
	</div>
	<!--end-vision-->
	<!--start-footer-->
	
	<!--end-footer-->
	
<script type="text/javascript">

var v1 = $.jStorage.get("key_s1");
var v2 = $.jStorage.get("key_s2")
var buttonS = document.getElementById('buttonS');
var dataLength = 0;
var follow ;
    function init() {
        var user = new Apiomat.User();
        user.setUserName("Admin");
        user.setPassword("12345");
        Apiomat.Datastore.configure(user);
        var saveCB = {
            onOk: function() {    
            },
            onError: function(error) {    
            }
        };
        user.loadMe({
            onOk: function() {
			loadTask();
            },
            onError: function(error) {
                user.save(saveCB);
            }
        });
    }
	
	
	 function loadTask() {
		
        var y = "email==" + '"' + v1 + '"' + " and " + "password==" + '"' + v2 + '"';
	
		Apiomat.Student.getStudents(y, {
        onOk: function(data) {
                for (var i = 0; i < data.length; i++) {
				
					 var array_follow = data[i].data.follow;
					 array_follow.split(",");
					 follow = (array_follow.split(","));
					 console.log(follow);

					 
                };
            },
            onError: function(error) {} });	
    }


    function searchTask() {
		document.getElementById("daftar_kursus").innerHTML = "";
		var a = document.getElementById("pengajar").value;
		var b = document.getElementById("nama_kursus").value;
        var y = "courses_teacher like" + '"' + a + '"' + " or " + "courses_name==" + '"' + b + '"';
	
		Apiomat.Courses.getCoursess(y, {
        onOk: function(data) {
                for (var i = 0; i < data.length; i++) {
				     dataLength = data.length;	
					 document.getElementById("statusS").innerHTML = "Hasil Pencarian ...";
					 console.log(data[i].getID())
				     if(_.includes(follow,data[i].getID())){
				     document.getElementById("daftar_kursus").innerHTML += "<tr><td>"+data[i].getCourses_name()+"</td><td><a href='dashboard-2View.html?id="+data[i].getTeacher_id()+"' target='_blank'><span id='nama_perusahaan'>"+data[i].getCourses_teacher()+"</span><a></td><td>"+data[i].getCourses_description()+"</td><td>"+data[i].getCourses_date()+"</td><td>"+data[i].getCourses_time()+"</td><td><a class = 'btn btn-default btn-lg' role = 'button' onclick='unfollowMe("+'"'+data[i].getID()+ '"'+")'>Batal Ikuti</button></a></td></tr>" ;
                     }
					 
					 else {
					 document.getElementById("daftar_kursus").innerHTML += "<tr><td>"+data[i].getCourses_name()+"</td><td><a href='dashboard-2View.html?id="+data[i].getTeacher_id()+"' target='_blank'><span id='nama_perusahaan'>"+data[i].getCourses_teacher()+"</span><a></td><td>"+data[i].getCourses_description()+"</td><td>"+data[i].getCourses_date()+"</td><td>"+data[i].getCourses_time()+"</td><td><a class = 'btn btn-default btn-lg' role = 'button' onclick='followMe("+'"'+data[i].getID()+ '"'+")'>Ikuti</button></a></td></tr>" ;
					 }
					 
	
				
				}	if (dataLength == 0){document.getElementById("statusS").innerHTML = '&nbsp;'+ "Mohon maaf. Pengajar atau Nama Kursus tidak ditemukan ..."; dataLength = 0;} else {dataLength = 0;}
            },
            onError: function(error) {} });	
    }
	
    function followMe(id) {


        follow.push(id);
		console.log(follow);
		save_follow(follow);

}

    function unfollowMe(id) {

	  _.pull(follow, id);
	    console.log(follow);
		 save_follow(follow);

}

function save_follow(id) {	
        var y = "email==" + '"' + v1 + '"' + " and " + "password==" + '"' + v2 + '"';
        var f_follow = follow;
		Apiomat.Student.getStudents(y, {
        onOk: function(data) {
                for (var i = 0; i < data.length; i++) {
					 saveTo_follow(f_follow,data[i]);
                };
            },
            onError: function(error) {} });	
    }
	
	

    

    function saveTo_follow(f_follow,data) {
      console.log(f_follow);
	  var joinArray = follow.join(",");
           data.setFollow(joinArray);
            data.save({
                onOk: function() {
                    
                }, onError: function(error) {}
            });     
    }
	
	
	
	
</script>
</body>
</html>